
<!DOCTYPE html>
<html class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content=""Use persisted queries to optimize your GraphQL powered applications!"">
      
      
      
        <meta name="author" content=""Michael Paris"">
      
      
        <link rel="shortcut icon" href="../../assets/images/favicon.png">
      
      <meta name="generator" content="mkdocs-0.16.2, mkdocs-material-1.3.0">
    
    
      
        <title>Get Started With Persisted Queries in GraphQL</title>
      
    
    
      <script src="../../assets/javascripts/modernizr-56ade86843.js"></script>
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application-1d1da4857d.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/base.css">
    
      <link rel="stylesheet" href="../../css/styles.css">
    
    
  </head>
  
  
  
  
    <body>
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <a href="../.." title="Scaphold Docs" class="md-icon md-icon--home md-header-nav__button">
          </a>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Tutorials
                </span>
              
            
            Using Persisted Queries
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search">
  <div class="md-search__overlay"></div>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" accesskey="s" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result"></div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <div class="md-header-nav__source">
          
            


  


  <a href="https://github.com/scaphold-io/scaphold-docs" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

          
        </div>
      </div>
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    
      <i class="md-icon md-icon--home md-nav__button"></i>
    
    Scaphold Docs
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/scaphold-io/scaphold-docs" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Getting Started
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Getting Started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../getting-started/jumpstart-video/" title="Jumpstart Video" class="md-nav__link">
      Jumpstart Video
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../getting-started/starter-kits/" title="Starter Kits" class="md-nav__link">
      Starter Kits
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Core Data
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Core Data
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../coredata/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../coredata/schema/" title="The Schema" class="md-nav__link">
      The Schema
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../coredata/queries/" title="Queries" class="md-nav__link">
      Queries
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../coredata/mutations/" title="Mutations" class="md-nav__link">
      Mutations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../coredata/subscriptions/" title="Subscriptions" class="md-nav__link">
      Subscriptions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../coredata/connections-pagination/" title="Connections" class="md-nav__link">
      Connections
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Authentication
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Authentication
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../authentication/tokens/" title="Auth Tokens" class="md-nav__link">
      Auth Tokens
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../authentication/permissions/" title="Permissions" class="md-nav__link">
      Permissions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../authentication/social/" title="Social Auth" class="md-nav__link">
      Social Auth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../authentication/super-users/" title="Super Users" class="md-nav__link">
      Super Users
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Realtime Subscriptions
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Realtime Subscriptions
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../realtime/subscriptions-apollo/" title="Subscriptions With Apollo Client" class="md-nav__link">
      Subscriptions With Apollo Client
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../realtime/subscriptions-react/" title="Subscriptions With React" class="md-nav__link">
      Subscriptions With React
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../realtime/slackr-chat-app/" title="Build Slack Tutorial" class="md-nav__link">
      Build Slack Tutorial
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Custom Logic
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Custom Logic
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../custom-logic/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../custom-logic/composition/" title="Function Composition" class="md-nav__link">
      Function Composition
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../custom-logic/pre-operations/" title="Pre Operations" class="md-nav__link">
      Pre Operations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../custom-logic/operation-phase/" title="Operation Phase" class="md-nav__link">
      Operation Phase
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../custom-logic/post-operations/" title="Post Operations" class="md-nav__link">
      Post Operations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../custom-logic/async-operations/" title="Async Operations" class="md-nav__link">
      Async Operations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../custom-logic/logs/" title="Logs & Examples" class="md-nav__link">
      Logs & Examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Persisted Queries
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Persisted Queries
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../persisted-queries/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../persisted-queries/getting-started/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../persisted-queries/querying-from-client/" title="Querying From Client" class="md-nav__link">
      Querying From Client
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Files
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Files
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../files/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../files/uploading/" title="Uploading" class="md-nav__link">
      Uploading
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../files/querying/" title="Querying" class="md-nav__link">
      Querying
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Integrations
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Integrations
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../integrations/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integrations/email/" title="Email" class="md-nav__link">
      Email
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integrations/monitoring/" title="Monitoring" class="md-nav__link">
      Monitoring
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integrations/passwordless/" title="Passwordless Auth" class="md-nav__link">
      Passwordless Auth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integrations/push/" title="Push Notifications" class="md-nav__link">
      Push Notifications
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-6" type="checkbox" id="nav-9-6">
    
    <label class="md-nav__link" for="nav-9-6">
      Search
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-9-6">
        Search
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../integrations/search/setup/" title="Setup" class="md-nav__link">
      Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integrations/search/querying/" title="Querying" class="md-nav__link">
      Querying
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-7" type="checkbox" id="nav-9-7">
    
    <label class="md-nav__link" for="nav-9-7">
      Social Auth
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-9-7">
        Social Auth
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../integrations/social/setup/" title="Setup" class="md-nav__link">
      Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integrations/social/login-with-native/" title="Login With Native SDKs" class="md-nav__link">
      Login With Native SDKs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integrations/social/login-with-auth0/" title="Login With Auth0" class="md-nav__link">
      Login With Auth0
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      App Management
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        App Management
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../app-management/alias/" title="Aliases" class="md-nav__link">
      Aliases
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../app-management/analytics/" title="Analytics" class="md-nav__link">
      Analytics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../app-management/export-schema/" title="Export Schema" class="md-nav__link">
      Export Schema
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../app-management/fork-app/" title="Fork App" class="md-nav__link">
      Fork App
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../app-management/teams/" title="Teams" class="md-nav__link">
      Teams
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../app-management/multi-region/" title="Multi Region" class="md-nav__link">
      Multi Region
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../app-management/admin-tokens/" title="Admin Tokens" class="md-nav__link">
      Admin Tokens
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../app-management/token-expiration/" title="Token Expiration" class="md-nav__link">
      Token Expiration
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11" checked>
    
    <label class="md-nav__link" for="nav-11">
      Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-11">
        Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../realtime-apps-with-subscriptions/" title="Build A Chat App" class="md-nav__link">
      Build A Chat App
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sending-push-notifications/" title="Sending Push Notifications" class="md-nav__link">
      Sending Push Notifications
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ios-push-notifications/" title="Setup iOS Push" class="md-nav__link">
      Setup iOS Push
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../android-push-notifications/" title="Setup Android Push" class="md-nav__link">
      Setup Android Push
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../migrate-mongodb-graphql/" title="Migrating MongoDB" class="md-nav__link">
      Migrating MongoDB
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Using Persisted Queries
      </label>
    
    <a href="./" title="Using Persisted Queries" class="md-nav__link md-nav__link--active">
      Using Persisted Queries
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-persisted-queries-work" title="How Persisted Queries Work" class="md-nav__link">
    How Persisted Queries Work
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started-with-persisted-queries" title="Getting Started with Persisted Queries" class="md-nav__link">
    Getting Started with Persisted Queries
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uploading-your-queries-to-scaphold" title="Uploading Your Queries to Scaphold" class="md-nav__link">
    Uploading Your Queries to Scaphold
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#add-persisted-queries-to-apollo-client" title="Add Persisted Queries To Apollo Client" class="md-nav__link">
    Add Persisted Queries To Apollo Client
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-persisted-queries-without-apollo-client" title="Using Persisted Queries Without Apollo Client" class="md-nav__link">
    Using Persisted Queries Without Apollo Client
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wrapping-up" title="Wrapping Up" class="md-nav__link">
    Wrapping Up
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../advanced-queries/" title="Advanced Relational Queries" class="md-nav__link">
      Advanced Relational Queries
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../authentication-in-graphql/" title="Authentication in GraphQL" class="md-nav__link">
      Authentication in GraphQL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../search-with-algolia/" title="Add Search With Algolia" class="md-nav__link">
      Add Search With Algolia
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../aggregations-in-graphql/" title="Aggregations In GraphQL" class="md-nav__link">
      Aggregations In GraphQL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../apollo-optics-graphql-server/" title="Integrate Apollo Optics" class="md-nav__link">
      Integrate Apollo Optics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../adding-social-auth/" title="Add Social Auth" class="md-nav__link">
      Add Social Auth
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../errors/" title="Errors" class="md-nav__link">
      Errors
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../changelog/" title="Changelog" class="md-nav__link">
      Changelog
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../faq/" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-persisted-queries-work" title="How Persisted Queries Work" class="md-nav__link">
    How Persisted Queries Work
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started-with-persisted-queries" title="Getting Started with Persisted Queries" class="md-nav__link">
    Getting Started with Persisted Queries
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uploading-your-queries-to-scaphold" title="Uploading Your Queries to Scaphold" class="md-nav__link">
    Uploading Your Queries to Scaphold
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#add-persisted-queries-to-apollo-client" title="Add Persisted Queries To Apollo Client" class="md-nav__link">
    Add Persisted Queries To Apollo Client
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-persisted-queries-without-apollo-client" title="Using Persisted Queries Without Apollo Client" class="md-nav__link">
    Using Persisted Queries Without Apollo Client
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wrapping-up" title="Wrapping Up" class="md-nav__link">
    Wrapping Up
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/scaphold-io/scaphold-docs/edit/master/docs/tutorials/persisted-queries.md" title="Edit this page" class="md-icon md-content__icon">edit</a>
                
                
                <h1 id="improve-performance-with-persisted-queries">Improve performance with persisted queries</h1>
<p>Today we are happy to announce support for persisted queries on Scaphold.
Persisted queries allow you store the text of your queries on our servers. This allow you to
optimize your app so it doesn't have to send the same query in each request which
can significantly decrease your application's bandwidth usage. Mobile devices with limited connectivity
benefit even more from persisted queries. It's quick and easy to start using persisted queries.
Let's check them out.</p>
<h2 id="how-persisted-queries-work">How Persisted Queries Work</h2>
<p>A traditional GraphQL request includes a request body that looks like this.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;query&quot;</span><span class="o">:</span> <span class="s2">&quot;query GetUser($id: ID!) { getUser(id: $id) { id username } }&quot;</span><span class="p">,</span>
  <span class="s2">&quot;variables&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="mi">7</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p><img alt="Persisted Queries" src="https://assets.scaphold.io/community/blog/persisted-queries/NoPersistence.png" /></p>
<p>This query is relatively small, but queries can get much larger. In a large application,
the bandwidth required to send these queries over and over again can have very real impacts on your
application's performance. Persisted queries fix this by transforming the above request into this.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="s2">&quot;variables&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="mi">7</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p><img alt="Persisted Queries" src="https://assets.scaphold.io/community/blog/persisted-queries/WithPersistence.png" /></p>
<p>Persisted queries require a mapping from query text to an ID. In our example, we would have a
mapping from the <strong>query</strong>:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>query GetUser($id: ID!) { getUser(id: $id) { id username } }
</pre></div>
</td></tr></table>

<p><br /></p>
<p>to the <strong>id</strong> <code>1</code>.</p>
<p>These mappings are stored as json documents that have the form</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">{</span> <span class="p">[</span><span class="nx">graphql_query</span><span class="p">]</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">ID</span> <span class="o">&gt;</span> <span class="p">}</span>
</pre></div>
</td></tr></table>

<p>For example, the mapping for our query to the right would look like this:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">{</span> <span class="s2">&quot;query getUser($id: ID!) { getUser(id: $id) { id username } }&quot;</span><span class="o">:</span> <span class="mi">1</span> <span class="p">}</span>
</pre></div>
</td></tr></table>

<p>Adding persisted queries to your API is easy! First create the mapping file, then upload it
to Scaphold via the <strong>GraphiQL</strong> tab in the portal. Once you have uploaded the file, you
can begin passing query ids instead of query text to our APIs.</p>
<h2 id="getting-started-with-persisted-queries">Getting Started with Persisted Queries</h2>
<p>The first step is to create the mapping from our GraphQL queries to their IDs. To do this we
will use the <code>persistgraphql</code> npm package. <code>persistgraphql</code> expects that you store your
queries as <code>.graphql</code> files in your source. If you aren't already doing this, the first step
is to move your queries out to their own <code>.graphql</code> files and then <code>import</code> those queries from your
components.</p>
<p>Once you have your queries separated out into their own files then run these commands:</p>
<p>1) <code>npm install -g persistgraphql</code></p>
<p>2) <code>persistgraphql &lt; projectdir &gt;</code></p>
<p>3) This will generate an <code>extracted_queries.json</code> file that you will upload to Scaphold.</p>
<blockquote>
<p>You can also point <code>persistgraphql</code> to a single <code>.graphql</code> file. Pointing it to a directory will
recursively pull queries out of every <code>.graphql</code> file.</p>
</blockquote>
<h2 id="uploading-your-queries-to-scaphold">Uploading Your Queries to Scaphold</h2>
<p>Uploading your <code>extracted_queries.json</code> file to Scaphold is easy. Go to the GraphiQL tab in your
<a href="https://scaphold.io">Scaphold</a> portal and click <strong>Persisted Queries</strong> in the page header.</p>
<p><img alt="Persisted Queries" src="https://assets.scaphold.io/community/blog/persisted-queries/graphiql-toolbar.png" /></p>
<p>This will open a side panel where you can drop your <code>extracted_queries.json</code> file.</p>
<p><img alt="Persisted Queries" src="https://assets.scaphold.io/community/blog/persisted-queries/persist-drop.png" /></p>
<p>We will automatically store this mapping so our servers know what query to call for a
particular query ID.</p>
<blockquote>
<p>We will store your queries in a database and cache them with Redis so you see the full speed benefits.</p>
</blockquote>
<h2 id="add-persisted-queries-to-apollo-client">Add Persisted Queries To Apollo Client</h2>
<p>Apollo Client comes with built-in support for persisted queries. To enable it, replace your
network interface with one that looks like this. This will automatically replace your query text
with the associated query ID without any changes to your code. Scaphold will handle replacing
the ID with the query text on the server.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kr">import</span> <span class="nx">queryMap</span> <span class="nx">from</span> <span class="err">‘</span><span class="p">.</span><span class="o">/</span><span class="nx">extracted_queries</span><span class="p">.</span><span class="nx">json</span><span class="err">’</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">PersistedQueryNetworkInterface</span> <span class="p">}</span> <span class="nx">from</span> <span class="err">‘</span><span class="nx">persistgraphql</span><span class="err">’</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">networkInterface</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PersistedQueryNetworkInterface</span><span class="p">({</span>
  <span class="nx">queryMap</span><span class="p">,</span>
  <span class="nx">uri</span><span class="o">:</span> <span class="nx">apiUrl</span><span class="p">,</span>
  <span class="nx">opts</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">headers</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">Authorization</span><span class="o">:</span> <span class="o">&lt;</span> <span class="nx">scaphold</span> <span class="nx">auth</span> <span class="nx">token</span> <span class="o">&gt;</span>
    <span class="p">},</span>
  <span class="p">},</span>
<span class="p">});</span>
<span class="kr">const</span> <span class="nx">client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ApolloClient</span><span class="p">({</span>
  <span class="nx">networkInterface</span><span class="p">,</span>
<span class="p">});</span>
</pre></div>
</td></tr></table>

<h2 id="using-persisted-queries-without-apollo-client">Using Persisted Queries Without Apollo Client</h2>
<p>Apollo Client makes it easy to use persisted queries but you're welcome to manage the queries
yourself. All you need to do is replace the <code>"query"</code> property in each of your requests with
the associated <code>"id"</code>. Keep in mind though, that it's up to you to make sure that you have updated
the most recent version of your queries to our servers.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;request&#39;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="s2">&quot;variables&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="mi">7</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">request</span><span class="p">({</span>
  <span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;https://us-west-2.api.scaphold.io/graphql/my-awesome-app&quot;</span><span class="p">,</span>
  <span class="nx">method</span><span class="o">:</span> <span class="s2">&quot;POST&quot;</span><span class="p">,</span>
  <span class="nx">json</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="nx">headers</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;content-type&quot;</span><span class="o">:</span> <span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="nx">body</span><span class="o">:</span> <span class="nx">data</span>
<span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">response</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">error</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span> <span class="o">==</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">body</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</td></tr></table>

<h2 id="wrapping-up">Wrapping Up</h2>
<p>I hope you enjoy these new features! Let me know what you think in the comments or connect
with us on slack!</p>
<div class="text-center">
  <p>
    <a href="http://slack.scaphold.io">Join us on Slack</a>
  </p>
  <p>
    <a href="http://slack.scaphold.io" target="_blank">
      <img style="max-width: 100px;" src="https://assets.scaphold.io/images/slack-icon.png"></img>
    </a>
  </p>
</div>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../migrate-mongodb-graphql/" title="Migrating MongoDB" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Migrating MongoDB
              </span>
            </div>
          </a>
        
        
          <a href="../advanced-queries/" title="Advanced Relational Queries" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Advanced Relational Queries
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application-7aa26ad9ec.js"></script>
      <script>app.initialize({url:{base:"../.."}})</script>
      
    
    
      
    
  </body>
</html>